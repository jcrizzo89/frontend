import{b as A}from"./chunk-EHG3IAXW.js";import{a as C}from"./chunk-NZ33N356.js";import{h as I,j as E}from"./chunk-MAVI32LF.js";import"./chunk-EJJBCPAK.js";import{O as k,ca as N,ea as L}from"./chunk-H2ONE3W6.js";import{b as _,d as u,g as M,h as S,k as w,m as y,o as F,t as P,v as O}from"./chunk-TSXBLCTM.js";import"./chunk-YCMZOG5D.js";import{c as x}from"./chunk-JLQOXKTP.js";import"./chunk-X7ZST7BG.js";import{$b as h,Ab as i,Bb as p,Ib as c,Ic as b,Lc as v,Ub as d,Wa as s,Xa as m,ia as g,mb as f,qb as l,zb as o}from"./chunk-G46DRSWM.js";function T(a,t){a&1&&(o(0,"span"),d(1,"Iniciar sesi\xF3n"),i())}function R(a,t){a&1&&p(0,"div",12)}var z=class a{constructor(t,n,e){this.fb=t;this.router=n;this.authService=e;this.loginForm=this.fb.group({username:["",[u.required]],password:["",[u.required]]})}loginForm;hidePassword=!0;error=null;loading=!1;matcher=new k;ngOnInit(){this.authService.isLoggedIn()&&(console.log("Usuario ya autenticado, redirigiendo al dashboard"),this.router.navigate(["/admin/dashboard"]))}onSubmit(){if(this.loginForm.valid){this.loading=!0,this.error=null;let{username:t,password:n}=this.loginForm.value;if(t==="admin"&&n==="admin"){let e={token:"mock-jwt-token",user:{id:1,email:"admin@agualuz.com",name:"Admin",role:"admin"}};try{this.authService.setSession(e),console.log("Sesi\xF3n guardada correctamente"),console.log("Usuario actual:",this.authService.getCurrentUser()),console.log("Token actual:",this.authService.getToken()),this.router.navigate(["/admin/dashboard"]).then(r=>{console.log("Navegaci\xF3n exitosa:",r),this.loading=!1},r=>{console.error("Error en navegaci\xF3n:",r),this.loading=!1,this.error="Error al redirigir al dashboard"})}catch(r){console.error("Error al guardar la sesi\xF3n:",r),this.error="Error al iniciar sesi\xF3n",this.loading=!1}}else this.loading=!1,this.error="Usuario o contrase\xF1a incorrectos"}else this.loginForm.markAllAsTouched()}getErrorMessage(t){return this.loginForm.get(t)?.hasError("required")?"Este campo es requerido":""}static \u0275fac=function(n){return new(n||a)(m(P),m(x),m(C))};static \u0275cmp=g({type:a,selectors:[["app-login"]],standalone:!0,features:[h],decls:20,vars:5,consts:[[1,"login"],[1,"login-card"],[1,"login-content"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","username","placeholder","Ingrese su usuario"],[1,"password-field"],["formControlName","password","placeholder","Ingrese su contrase\xF1a",3,"type"],["type","button",1,"show-btn",3,"click"],["type","submit",1,"submit-btn",3,"disabled"],[4,"ngIf"],["class","spinner",4,"ngIf"],[1,"spinner"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),d(4,"Iniciar sesi\xF3n"),i(),o(5,"form",3),c("ngSubmit",function(){return e.onSubmit()}),o(6,"div",4)(7,"label"),d(8,"Usuario"),i(),p(9,"input",5),i(),o(10,"div",4)(11,"label"),d(12,"Contrase\xF1a"),i(),o(13,"div",6),p(14,"input",7),o(15,"button",8),c("click",function(){return e.hidePassword=!e.hidePassword}),d(16,"Mostrar"),i()()(),o(17,"button",9),f(18,T,2,0,"span",10)(19,R,1,0,"div",11),i()()()()()),n&2&&(s(5),l("formGroup",e.loginForm),s(9),l("type",e.hidePassword?"password":"text"),s(3),l("disabled",e.loginForm.invalid||e.loading),s(),l("ngIf",!e.loading),s(),l("ngIf",e.loading))},dependencies:[v,b,O,w,_,M,S,y,F,I,E,N,L,A],styles:[".login[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(109.37deg,#32a2da 13.44%,#1b5674 95.84%);padding:20px}.login-card[_ngcontent-%COMP%]{width:100%;max-width:634px;background:#ececec;border-radius:31px;padding:24px 56px;box-sizing:border-box}.logo[_ngcontent-%COMP%]{display:block;margin:0 auto 24px;height:40px;width:auto}.login-content[_ngcontent-%COMP%]{width:100%}h2[_ngcontent-%COMP%]{color:#0051d6;font-size:29px;font-weight:700;text-align:center;margin:0 0 24px}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}label[_ngcontent-%COMP%]{color:#0051d6;font-size:16px;font-weight:700;padding-left:4px}input[_ngcontent-%COMP%]{height:47px;background:#fafbfc;border:1px solid #32A2DA;border-radius:4px;padding:0 16px;font-size:14px;width:100%;box-sizing:border-box}input[_ngcontent-%COMP%]::placeholder{color:#757575}.password-field[_ngcontent-%COMP%]{position:relative}.show-btn[_ngcontent-%COMP%]{position:absolute;right:16px;top:50%;transform:translateY(-50%);background:none;border:none;color:#32a2da;font-size:14px;cursor:pointer;padding:0}.submit-btn[_ngcontent-%COMP%]{height:47px;background:#32a2da;border-radius:4px;border:none;color:#fff;font-size:16px;font-weight:700;width:100%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background-color .2s}.submit-btn[_ngcontent-%COMP%]:hover{background:#0051d6}.submit-btn[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid white;border-top:3px solid transparent;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};export{z as LoginComponent};
